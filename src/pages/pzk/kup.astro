---
/**
 * PZK Purchase Landing Page (/pzk/kup)
 *
 * Public marketing page presenting PZK modules and purchase options.
 * - No authentication required
 * - SSR-first (no hydration needed)
 * - External CTA links open in new tab
 */

import { isFeatureEnabled } from '@/lib/feature-flags'

// Feature flag: Return 404 if PZK is disabled
if (!isFeatureEnabled('PZK')) {
  return new Response(null, { status: 404, statusText: 'Not Found' })
}

import Layout from '@/layouts/Layout.astro'
import PzkPurchaseHero from '@/components/pzk/PzkPurchaseHero.astro'
import PzkPurchaseForWho from '@/components/pzk/PzkPurchaseForWho.astro'
import PzkPurchaseHowItWorks from '@/components/pzk/PzkPurchaseHowItWorks.astro'
import PzkPurchaseSupport from '@/components/pzk/PzkPurchaseSupport.astro'
import PzkPurchaseBenefits from '@/components/pzk/PzkPurchaseBenefits.astro'
import PzkPurchaseModules from '@/components/pzk/PzkPurchaseModules.astro'
import PzkPurchaseCtaBar from '@/components/pzk/PzkPurchaseCtaBar.astro'
import PzkPurchaseFaq from '@/components/pzk/PzkPurchaseFaq.astro'
import type { PzkPurchaseLandingVM, PzkModuleNumber } from '@/types/pzk-dto'
import { buildPurchaseUrl } from '@/lib/pzk/config'
import { isFeatureEnabled } from '@/lib/feature-flags'

// Check if login link should be shown (only when STREFA_PACJENTA is enabled)
const showLoginLink = isFeatureEnabled('STREFA_PACJENTA')

// Build ViewModel for the page
const viewModel: PzkPurchaseLandingVM = {
  seo: {
    title: '90-dniowy Program Budowania Zdrowych Nawyk贸w | Przestrze Zdrowej Kobiety',
    description: '90-dniowy program dla kobiet z codziennym wsparciem dietetyka. Bez presji, bez chaosu - tylko realna zmiana. Regulacja hormon贸w, zdrowa redukcja, lepsza relacja z jedzeniem. Start: 23 stycznia.'
  },

  hero: {
    title: 'Przestrze Zdrowej Kobiety',
    subtitle: '90-dniowy program budowania zdrowych nawyk贸w',
    lead: 'Bez presji. Bez chaosu. Bez zaczynania od nowa. Z realnym wsparciem dietetyka, kt贸ry idzie obok Ciebie przez cay proces.',
    highlights: [
      '90 dni prowadzenia',
      'Codzienne wsparcie na Telegramie',
      'Q&A 2x w miesicu',
      'Start: 23 stycznia'
    ],
    primaryCta: {
      label: 'Sprawd藕, jak dziaa program',
      href: '#jak-dziala',
      isExternal: false
    }
  },

  forWho: {
    title: 'Czy to brzmi znajomo?',
    subtitle: 'Ten program jest dla Ciebie, jeli:',
    painPoints: [
      'Masz za sob wiele nieudanych pr贸b - jadospisy, diety, detoksy, "jem mniej"',
      'Czujesz chaos informacyjny i nie wiesz, od czego zacz',
      'Brakuje Ci konsekwencji i wsparcia w najbli偶szym otoczeniu',
      'Chcesz schudn, ale bez presji, zakaz贸w i fit-idealizmu',
      'Zmagasz si z wahaniami masy ciaa, spadkami energii, nieregularnymi cyklami',
      'Nie wierzysz ju偶 w kolejn diet - chcesz trwaych nawyk贸w, a nie chwilowego efektu'
    ],
    notForYouTitle: 'Ten program NIE jest dla Ciebie, jeli:',
    notForYou: [
      'Szukasz szybkich efekt贸w "-10 kg w miesic"',
      'Chcesz restrykcji, zakaz贸w i presji',
      'Liczysz na "magiczn metod bez dziaania"',
      'Nie jeste gotowa na nawet minimalne zaanga偶owanie (15-30 min dziennie)'
    ]
  },

  howItWorks: {
    title: 'Jak dziaa program?',
    subtitle: 'Prosta struktura, kt贸ra naprawd dziaa',
    features: [
      {
        icon: 'calendar' as const,
        title: '90 dni systematycznego dziaania',
        description: '3 miesice prowadzenia krok po kroku. Wystarczajco dugo, by zmiana staa si nawykiem. Start: 23 stycznia.'
      },
      {
        icon: 'target' as const,
        title: '1 nawyk = 1 tydzie',
        description: 'Bez natoku, bez "wszystko naraz". Jeden tydzie, jeden nowy nawyk. Prosty model, kt贸ry nie przytacza.'
      },
      {
        icon: 'clock' as const,
        title: '15-30 minut dziennie',
        description: 'Realistyczny czas dla zapracowanej kobiety. Plus przygotowanie prostych posik贸w rozo偶one w tygodniu.'
      },
      {
        icon: 'play' as const,
        title: 'Materiay dostpne przez 12 miesicy',
        description: 'Wracaj do treci kiedy chcesz. Uczysz si we wasnym tempie, bez presji czasu.'
      }
    ]
  },

  support: {
    title: 'Nie jeste sama w tym procesie',
    subtitle: 'To, co wyr贸偶nia ten program:',
    supportFeatures: [
      {
        title: 'Codzienne wsparcie dietetyka (PN-PT) na Telegramie',
        description: 'Kr贸tkie wiadomoci tekstowe, gos贸wki, grafiki motywacyjne. Przypominanie o zadaniach i reagowanie na Twoje wyzwania. Realna obecno - 10-20 minut dziennie.',
        badge: ' Najwa偶niejsze'
      },
      {
        title: 'Q&A 2x w miesicu',
        description: 'Spotkania na 偶ywo, gdzie mo偶esz zada pytania. Pytania zbierane tak偶e na bie偶co przez formularz. Nagrania dostpne po spotkaniu.'
      }
    ]
  },

  benefits: {
    title: 'Co zyskasz po 90 dniach?',
    subtitle: 'Efekty, kt贸re zostaj z Tob na lata',
    benefits: [
      {
        icon: 'scale' as const,
        title: 'Zdrowa redukcja masy ciaa',
        description: '2-4 kg tuszczu miesicznie. Mo偶liwo pracy bez wagi (centymetry, samopoczucie).'
      },
      {
        icon: 'heart' as const,
        title: 'Lepsza relacja z jedzeniem',
        description: 'Koniec z poczuciem winy, zakazami i "zaczynam od poniedziaku".'
      },
      {
        icon: 'energy' as const,
        title: 'Wicej energii',
        description: 'Odzyskasz si do 偶ycia, pracy i radoci z codziennoci.'
      },
      {
        icon: 'mind' as const,
        title: 'Spok贸j i poczucie kontroli',
        description: 'Zamiast chaosu - jasny kierunek i zaufanie do procesu.'
      },
      {
        icon: 'growth' as const,
        title: 'Poczucie sprawczoci',
        description: 'Wiara w siebie i swoje mo偶liwoci. Wiesz, 偶e potrafisz.'
      },
      {
        icon: 'calendar' as const,
        title: 'Trwae nawyki',
        description: 'Zmiana, kt贸ra zostaje - nie tylko przez 90 dni, ale na lata.'
      }
    ],
    note: '* Efekty mog si r贸偶ni w zale偶noci od indywidualnej sytuacji zdrowotnej i zaanga偶owania w program.'
  },

  modules: [
    {
      module: 1 as PzkModuleNumber,
      title: 'Modu 1',
      subtitle: 'Fundamenty zdrowego 偶ywienia',
      bullets: [
        'Materiay edukacyjne PDF z podstawami dietetyki',
        'Filmy wideo: jak budowa zdrowe nawyki krok po kroku',
        'Checklisty i plany dziaania do pobrania',
        'Dostp przez 12 miesicy do wszystkich treci',
        'Mo偶liwo tworzenia wasnych notatek do materia贸w'
      ],
      ctaLabel: 'Kup modu 1',
      ctaUrl: buildPurchaseUrl(1)
    },
    {
      module: 2 as PzkModuleNumber,
      title: 'Modu 2',
      subtitle: 'Hormony, cykl, metabolizm',
      bullets: [
        'Szczeg贸owe materiay PDF o r贸wnowadze hormonalnej',
        'Filmy wideo: jak wspiera hormony przez 偶ywienie',
        'Praktyczne wskaz贸wki dla kobiet z PCOS, insulinoopornoci',
        'Dostp przez 12 miesicy bez limit贸w',
        'System notatek - zapisuj swoje spostrze偶enia'
      ],
      ctaLabel: 'Kup modu 2',
      ctaUrl: buildPurchaseUrl(2)
    },
    {
      module: 3 as PzkModuleNumber,
      title: 'Modu 3',
      subtitle: 'Zaawansowane strategie 偶ywieniowe',
      bullets: [
        'Kompleksowe materiay PDF dla zaawansowanych',
        'Filmy szkoleniowe: jak optymalizowa diet',
        'Strategie dla szczeg贸lnych cel贸w zdrowotnych',
        'Dostp przez 12 miesicy do penej biblioteki',
        'Notatki i zapiski - buduj wasn baz wiedzy'
      ],
      ctaLabel: 'Kup modu 3',
      ctaUrl: buildPurchaseUrl(3)
    }
  ],

  ctaBar: {
    showLoginLink,
    loginHref: '/logowanie',
    patientGateHref: '/pacjent/pzk',
    contactHref: '/kontakt'
  },

  faq: [
    {
      id: 'faq-1',
      question: 'Kiedy startuje program i jak dugo trwa?',
      answerMd: 'Program startuje 23 stycznia i trwa 90 dni (3 miesice). To wystarczajco dugo, by wprowadzone zmiany stay si nawykiem. Mo偶esz doczy do 7 dni po starcie.'
    },
    {
      id: 'faq-2',
      question: 'Ile czasu dziennie musz powici?',
      answerMd: 'Realistycznie: **15-30 minut dziennie** na materiay i zadania. Plus czas na przygotowanie prostych posik贸w (rozo偶one w tygodniu). To program dla zapracowanych kobiet - nie wymaga godzin wolnego czasu.'
    },
    {
      id: 'faq-3',
      question: 'Jak wyglda wsparcie dietetyka?',
      answerMd: 'Otrzymujesz codzienne wsparcie (PN-PT) na Telegramie: kr贸tkie wiadomoci, gos贸wki, grafiki motywacyjne, przypomnienia o zadaniach. Plus **Q&A 2x w miesicu na 偶ywo** - mo偶esz zada pytania, nagrania dostpne p贸藕niej.'
    },
    {
      id: 'faq-4',
      question: 'Czy musz kupi wszystkie moduy?',
      answerMd: 'Nie, mo偶esz kupi dowolny modu osobno. Ka偶dy modu to samodzielna cz programu. Jeli chcesz penego dostpu, mo偶esz kupi kilka lub wszystkie moduy.'
    },
    {
      id: 'faq-5',
      question: 'Jak dugo mam dostp do materia贸w?',
      answerMd: 'Dostp do zakupionych materia贸w (PDF, filmy wideo) masz przez 12 miesicy. Mo偶esz wraca do treci kiedy chcesz i uczy si we wasnym tempie.'
    },
    {
      id: 'faq-6',
      question: 'Co jeli nie dam rady wszystkiego zrobi w tygodniu?',
      answerMd: 'Program jest elastyczny. Jeli masz trudny tydzie, mo偶esz wr贸ci do materiau p贸藕niej. Nie ma presji "zd偶y" - wa偶niejsza jest konsekwencja ni偶 tempo.'
    },
    {
      id: 'faq-7',
      question: 'Czy to jest dieta i jadospis?',
      answerMd: 'NIE - to nie jest kolejna dieta z jadospisem. To program budowania zdrowych nawyk贸w, uczenia si wiadomego 偶ywienia i zmiany relacji z jedzeniem. Bez zakaz贸w, bez presji, bez "od poniedziaku".'
    },
    {
      id: 'faq-8',
      question: 'Jakie efekty mog osign?',
      answerMd: 'Realistyczne efekty to: 2-4 kg tuszczu miesicznie, lepsza relacja z jedzeniem, wicej energii, spok贸j i poczucie kontroli. Mo偶esz te偶 pracowa bez wagi (centymetry, samopoczucie). Efekty zale偶 od Twojej indywidualnej sytuacji i zaanga偶owania.'
    },
    {
      id: 'faq-9',
      question: 'Czy program jest odpowiedni dla mnie, jeli mam PCOS/insulinooporno?',
      answerMd: 'TAK! Program uwzgldnia potrzeby kobiet z PCOS, insulinoopornoci, nieregularnymi cyklami. Materiay zawieraj konkretne wskaz贸wki 偶ywieniowe dla tych schorze.'
    },
    {
      id: 'faq-10',
      question: 'Czy musz mie konto, aby kupi dostp?',
      answerMd: 'Nie, zakup odbywa si przez bezpieczn bramk patnoci. Po zakupie otrzymasz instrukcje, jak zao偶y konto i aktywowa dostp do materia贸w.'
    },
    {
      id: 'faq-11',
      question: 'Czy mog pobra materiay PDF na swoje urzdzenie?',
      answerMd: 'TAK - po zalogowaniu mo偶esz przeglda materiay PDF online oraz pobiera je na komputer, telefon lub tablet. Ka偶dy materia jest w wysokiej jakoci.'
    },
    {
      id: 'faq-12',
      question: 'Co jeli nie jestem zadowolona z programu?',
      answerMd: 'Rozumiem, 偶e zakup online wymaga zaufania. Jeli po rozpoczciu programu stwierdzisz, 偶e to nie dla Ciebie, skontaktuj si ze mn - indywidualnie om贸wimy sytuacj.'
    }
  ]
}
---

<Layout title={viewModel.seo.title} description={viewModel.seo.description}>
  <PzkPurchaseHero
    title={viewModel.hero.title}
    subtitle={viewModel.hero.subtitle}
    lead={viewModel.hero.lead}
    highlights={viewModel.hero.highlights}
    primaryCta={viewModel.hero.primaryCta}
  />

  <PzkPurchaseForWho
    title={viewModel.forWho.title}
    subtitle={viewModel.forWho.subtitle}
    painPoints={viewModel.forWho.painPoints}
    notForYouTitle={viewModel.forWho.notForYouTitle}
    notForYou={viewModel.forWho.notForYou}
  />

  <PzkPurchaseHowItWorks
    id="jak-dziala"
    title={viewModel.howItWorks.title}
    subtitle={viewModel.howItWorks.subtitle}
    features={viewModel.howItWorks.features}
  />

  <PzkPurchaseSupport
    title={viewModel.support.title}
    subtitle={viewModel.support.subtitle}
    supportFeatures={viewModel.support.supportFeatures}
  />

  <PzkPurchaseBenefits
    title={viewModel.benefits.title}
    subtitle={viewModel.benefits.subtitle}
    benefits={viewModel.benefits.benefits}
    note={viewModel.benefits.note}
  />

  <PzkPurchaseModules
    modules={viewModel.modules}
    fallbackContactHref={viewModel.ctaBar.contactHref}
  />

  {viewModel.faq && <PzkPurchaseFaq items={viewModel.faq} />}

  <PzkPurchaseCtaBar
    showLoginLink={viewModel.ctaBar.showLoginLink}
    loginHref={viewModel.ctaBar.loginHref}
    patientGateHref={viewModel.ctaBar.patientGateHref}
    contactHref={viewModel.ctaBar.contactHref}
  />
</Layout>
