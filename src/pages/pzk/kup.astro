---
/**
 * PZK Purchase Landing Page (/pzk/kup)
 *
 * Public marketing page presenting PZK modules and purchase options.
 * - No authentication required
 * - SSR-first (no hydration needed)
 * - External CTA links open in new tab
 */

import { isFeatureEnabled } from '@/lib/feature-flags'

// Feature flag: Return 404 if PZK is disabled
if (!isFeatureEnabled('PZK')) {
  return new Response(null, { status: 404, statusText: 'Not Found' })
}

import Layout from '@/layouts/Layout.astro'
import PzkPurchaseAnnouncementBar from '@/components/pzk/PzkPurchaseAnnouncementBar.astro'
import PzkPurchaseHero from '@/components/pzk/PzkPurchaseHero.astro'
import PzkPurchaseForWho from '@/components/pzk/PzkPurchaseForWho.astro'
import PzkPurchaseHowItWorks from '@/components/pzk/PzkPurchaseHowItWorks.astro'
import PzkPurchaseSupport from '@/components/pzk/PzkPurchaseSupport.astro'
import PzkPurchaseBenefits from '@/components/pzk/PzkPurchaseBenefits.astro'
import PzkPurchaseModules from '@/components/pzk/PzkPurchaseModules.astro'
import PzkPurchaseBundleCard from '@/components/pzk/PzkPurchaseBundleCard.astro'
import PzkPurchaseCtaBar from '@/components/pzk/PzkPurchaseCtaBar.astro'
import PzkPurchaseFaq from '@/components/pzk/PzkPurchaseFaq.astro'
import PzkFloatingCta from '@/components/pzk/PzkFloatingCta'
import type { PzkPurchaseLandingVM, PzkModuleNumber } from '@/types/pzk-dto'
import { buildPurchaseUrl } from '@/lib/pzk/config'
import { isFeatureEnabled } from '@/lib/feature-flags'

// Check if login link should be shown (only when STREFA_PACJENTA is enabled)
const showLoginLink = isFeatureEnabled('STREFA_PACJENTA')

// Build ViewModel for the page
const viewModel: PzkPurchaseLandingVM = {
  seo: {
    title: '90-dniowy Program Budowania Zdrowych NawykÃ³w | PrzestrzeÅ„ Zdrowej Kobiety',
    description: '90-dniowy program dla kobiet z codziennym wsparciem dietetyka. Bez presji, bez chaosu - tylko realna zmiana. Regulacja hormonÃ³w, zdrowa redukcja, lepsza relacja z jedzeniem. Start: 20 stycznia.'
  },

  hero: {
    title: 'PrzestrzeÅ„ Zdrowej Kobiety',
    subtitle: '90-dniowy program budowania zdrowych nawykÃ³w',
    lead: 'Bez presji. Bez chaosu. Bez zaczynania od nowa. Z realnym wsparciem dietetyka, ktÃ³ry idzie obok Ciebie przez caÅ‚y proces.',
    highlights: [
      '90 dni prowadzenia',
      'Codzienne wsparcie na Telegramie',
      'Q&A 2x w miesiÄ…cu',
      'Start: 20 stycznia'
    ],
    primaryCta: {
      label: 'DoÅ‚Ä…cz do programu',
      href: '#moduly',
      isExternal: false
    },
    secondaryCta: {
      label: 'Zobacz, jak dziaÅ‚a',
      href: '#jak-dziala',
      isExternal: false
    }
  },

  forWho: {
    title: 'Czy to brzmi znajomo?',
    subtitle: 'Ten program jest dla Ciebie, jeÅ›li:',
    painPoints: [
      'Masz za sobÄ… wiele nieudanych prÃ³b - jadÅ‚ospisy, diety, detoksy, "jem mniej"',
      'Czujesz chaos informacyjny i nie wiesz, od czego zaczÄ…Ä‡',
      'Brakuje Ci konsekwencji i wsparcia w najbliÅ¼szym otoczeniu',
      'Chcesz schudnÄ…Ä‡, ale bez presji, zakazÃ³w i fit-idealizmu',
      'Zmagasz siÄ™ z wahaniami masy ciaÅ‚a, spadkami energii, nieregularnymi cyklami',
      'Nie wierzysz juÅ¼ w kolejnÄ… dietÄ™ - chcesz trwaÅ‚ych nawykÃ³w, a nie chwilowego efektu'
    ],
    notForYouTitle: 'Ten program NIE jest dla Ciebie, jeÅ›li:',
    notForYou: [
      'Szukasz szybkich efektÃ³w "-10 kg w miesiÄ…c"',
      'Chcesz restrykcji, zakazÃ³w i presji',
      'Liczysz na "magicznÄ… metodÄ™ bez dziaÅ‚ania"',
      'Nie jesteÅ› gotowa na nawet minimalne zaangaÅ¼owanie (15-30 min dziennie)'
    ]
  },

  howItWorks: {
    title: 'Jak dziaÅ‚a program?',
    subtitle: 'Prosta struktura, ktÃ³ra naprawdÄ™ dziaÅ‚a',
    features: [
      {
        icon: 'calendar' as const,
        title: '90 dni systematycznego dziaÅ‚ania',
        description: '3 miesiÄ…ce prowadzenia krok po kroku. WystarczajÄ…co dÅ‚ugo, by zmiana staÅ‚a siÄ™ nawykiem. Start: 20 stycznia.'
      },
      {
        icon: 'target' as const,
        title: '1 nawyk = 1 tydzieÅ„',
        description: 'Bez natÅ‚oku, bez "wszystko naraz". Jeden tydzieÅ„, jeden nowy nawyk. Prosty model, ktÃ³ry nie przytÅ‚acza.'
      },
      {
        icon: 'clock' as const,
        title: '15-30 minut dziennie',
        description: 'Realistyczny czas dla zapracowanej kobiety. Plus przygotowanie prostych posiÅ‚kÃ³w rozÅ‚oÅ¼one w tygodniu.'
      },
      {
        icon: 'play' as const,
        title: 'MateriaÅ‚y dostÄ™pne przez 12 miesiÄ™cy',
        description: 'Wracaj do treÅ›ci kiedy chcesz. Uczysz siÄ™ we wÅ‚asnym tempie, bez presji czasu.'
      }
    ]
  },

  support: {
    title: 'Nie jesteÅ› sama w tym procesie',
    subtitle: 'To, co wyrÃ³Å¼nia ten program:',
    supportFeatures: [
      {
        title: 'Codzienne wsparcie dietetyka (PN-PT) na Telegramie',
        description: 'KrÃ³tkie wiadomoÅ›ci tekstowe, gÅ‚osÃ³wki, grafiki motywacyjne. Przypominanie o zadaniach i reagowanie na Twoje wyzwania. Realna obecnoÅ›Ä‡ - 10-20 minut dziennie.',
        badge: 'ğŸ”¥ NajwaÅ¼niejsze'
      },
      {
        title: 'Q&A 2x w miesiÄ…cu',
        description: 'Spotkania na Å¼ywo, gdzie moÅ¼esz zadaÄ‡ pytania. Pytania zbierane takÅ¼e na bieÅ¼Ä…co przez formularz. Nagrania dostÄ™pne po spotkaniu.'
      }
    ]
  },

  benefits: {
    title: 'Co zyskasz po 90 dniach?',
    subtitle: 'Efekty, ktÃ³re zostajÄ… z TobÄ… na lata',
    benefits: [
      {
        icon: 'scale' as const,
        title: 'Zdrowa redukcja masy ciaÅ‚a',
        description: '2-4 kg tÅ‚uszczu miesiÄ™cznie. MoÅ¼liwoÅ›Ä‡ pracy bez wagi (centymetry, samopoczucie).'
      },
      {
        icon: 'heart' as const,
        title: 'Lepsza relacja z jedzeniem',
        description: 'Koniec z poczuciem winy, zakazami i "zaczynam od poniedziaÅ‚ku".'
      },
      {
        icon: 'energy' as const,
        title: 'WiÄ™cej energii',
        description: 'Odzyskasz siÅ‚Ä™ do Å¼ycia, pracy i radoÅ›ci z codziennoÅ›ci.'
      },
      {
        icon: 'mind' as const,
        title: 'SpokÃ³j i poczucie kontroli',
        description: 'Zamiast chaosu - jasny kierunek i zaufanie do procesu.'
      },
      {
        icon: 'growth' as const,
        title: 'Poczucie sprawczoÅ›ci',
        description: 'Wiara w siebie i swoje moÅ¼liwoÅ›ci. Wiesz, Å¼e potrafisz.'
      },
      {
        icon: 'calendar' as const,
        title: 'TrwaÅ‚e nawyki',
        description: 'Zmiana, ktÃ³ra zostaje - nie tylko przez 90 dni, ale na lata.'
      }
    ],
    note: '* Efekty mogÄ… siÄ™ rÃ³Å¼niÄ‡ w zaleÅ¼noÅ›ci od indywidualnej sytuacji zdrowotnej i zaangaÅ¼owania w program.'
  },

  bundle: {
    title: 'Pakiet 3 moduÅ‚Ã³w',
    subtitle: 'Kompletny program - oszczÄ™dzasz 248 zÅ‚',
    price: 999,
    originalPrice: 1199,
    discountBadge: 'PROMOCJA',
    promotionNote: 'Cena promocyjna waÅ¼na do 27 stycznia',
    bullets: [
      'DostÄ™p do wszystkich 3 moduÅ‚Ã³w programu',
      'MateriaÅ‚y dostÄ™pne przez 12 miesiÄ™cy bez limitu',
      'PeÅ‚ne wsparcie dietetyka przez 90 dni',
      'OszczÄ™dzasz 248 zÅ‚ w porÃ³wnaniu do zakupu osobnego (3Ã—349 zÅ‚)',
    ],
    ctaLabel: 'Kup pakiet - 999 zÅ‚',
  },

  modules: [
    {
      module: 1 as PzkModuleNumber,
      title: 'ModuÅ‚ 1',
      subtitle: 'Fundamenty zdrowego Å¼ywienia',
      price: 349,
      originalPrice: 449,
      discountBadge: 'PROMOCJA',
      promotionNote: 'Cena promocyjna waÅ¼na do 27 stycznia',
      contentSections: [
        {
          heading: 'Zaczynamy',
          items: [
            'Wideo powitalne',
            'Instrukcja jak korzystaÄ‡ z PZK',
            'Zasady pracy w grupie',
            'Weryfikacja postÄ™pÃ³w',
          ]
        },
        {
          heading: 'WykÅ‚ady',
          items: [
            'Woda',
            'WielkoÅ›Ä‡ porcji i kalorycznoÅ›Ä‡',
            'BiaÅ‚ko',
            'WÄ™glowodany',
          ]
        },
        {
          heading: 'Plany Å¼ywieniowe + dodatki',
          items: [
            'JadÅ‚ospis 2 Ã— 7 dni â†’ 1600/1800/2000/2200 kcal',
            'Jak obliczyÄ‡ zapotrzebowanie oraz kcal',
            'Przepisy na napoje',
            'Przepisy na koktajle proteinowe',
          ]
        },
        {
          heading: 'Plany suplementacyjne',
          items: []
        }
      ],
      bullets: [
        'MateriaÅ‚y edukacyjne z podstawami dietetyki',
        'Filmy wideo: jak budowaÄ‡ zdrowe nawyki krok po kroku',
        'DostÄ™p przez 12 miesiÄ™cy do wszystkich treÅ›ci',
      ],
      ctaLabel: 'Kup moduÅ‚ 1 - 349 zÅ‚',
      ctaUrl: buildPurchaseUrl(1)
    },
    {
      module: 2 as PzkModuleNumber,
      title: 'ModuÅ‚ 2',
      subtitle: 'Hormony, cykl, metabolizm',
      price: 349,
      originalPrice: 449,
      discountBadge: 'PROMOCJA',
      promotionNote: 'Cena promocyjna waÅ¼na do 27 stycznia',
      contentSections: [
        {
          heading: 'Zaczynamy',
          items: []
        },
        {
          heading: 'WykÅ‚ady',
          items: [
            'Jelita',
            'TÅ‚uszcze',
            'Metabolizm',
            'Antyoksydanty',
          ]
        },
        {
          heading: 'Plany Å¼ywieniowe',
          items: [
            '2 nowe jadÅ‚ospisy!',
          ]
        },
        {
          heading: 'Plany suplementacyjne',
          items: []
        }
      ],
      bullets: [
        'SzczegÃ³Å‚owe materiaÅ‚y PDF o rÃ³wnowadze hormonalnej',
        'Filmy wideo: jak wspieraÄ‡ hormony przez Å¼ywienie',
        'DostÄ™p przez 12 miesiÄ™cy bez limitÃ³w',
      ],
      ctaLabel: 'Kup moduÅ‚ 2 - 349 zÅ‚',
      ctaUrl: buildPurchaseUrl(2)
    },
    {
      module: 3 as PzkModuleNumber,
      title: 'ModuÅ‚ 3',
      subtitle: 'Zaawansowane strategie Å¼ywieniowe',
      price: 349,
      originalPrice: 449,
      discountBadge: 'PROMOCJA',
      promotionNote: 'Cena promocyjna waÅ¼na do 27 stycznia',
      contentSections: [
        {
          heading: 'Zaczynamy',
          items: []
        },
        {
          heading: 'WykÅ‚ady',
          items: [
            'Stres i emocje a waga',
            'Sen',
            'Ruch',
            'WykÅ‚ad bonusowy',
          ]
        },
        {
          heading: 'Plany Å¼ywieniowe',
          items: [
            '2 nowe jadÅ‚ospisy!',
          ]
        },
        {
          heading: 'Plany suplementacyjne',
          items: []
        }
      ],
      bullets: [
        'Kompleksowe materiaÅ‚y PDF dla zaawansowanych',
        'Filmy szkoleniowe: jak optymalizowaÄ‡ dietÄ™',
        'DostÄ™p przez 12 miesiÄ™cy do peÅ‚nej biblioteki',
      ],
      ctaLabel: 'Kup moduÅ‚ 3 - 349 zÅ‚',
      ctaUrl: buildPurchaseUrl(3)
    }
  ],

  ctaBar: {
    showLoginLink,
    loginHref: '/logowanie',
    patientGateHref: '/pacjent/pzk',
    contactHref: '/kontakt'
  },

  faq: [
    {
      id: 'faq-1',
      question: 'Kiedy startuje program i jak dÅ‚ugo trwa?',
      answerMd: 'Program startuje 20 stycznia i trwa 90 dni (3 miesiÄ…ce). To wystarczajÄ…co dÅ‚ugo, by wprowadzone zmiany staÅ‚y siÄ™ nawykiem. MoÅ¼esz doÅ‚Ä…czyÄ‡ do 7 dni po starcie.'
    },
    {
      id: 'faq-2',
      question: 'Ile czasu dziennie muszÄ™ poÅ›wiÄ™ciÄ‡?',
      answerMd: 'Realistycznie: 15-30 minut dziennie na materiaÅ‚y i zadania. Plus czas na przygotowanie prostych posiÅ‚kÃ³w (rozÅ‚oÅ¼one w tygodniu). To program dla zapracowanych kobiet - nie wymaga godzin wolnego czasu.'
    },
    {
      id: 'faq-3',
      question: 'Jak wyglÄ…da wsparcie dietetyka?',
      answerMd: 'Otrzymujesz codzienne wsparcie (PN-PT) na Telegramie: krÃ³tkie wiadomoÅ›ci, gÅ‚osÃ³wki, grafiki motywacyjne, przypomnienia o zadaniach. Plus Q&A 2x w miesiÄ…cu na Å¼ywo - moÅ¼esz zadaÄ‡ pytania, nagrania dostÄ™pne pÃ³Åºniej.'
    },
    {
      id: 'faq-4',
      question: 'Czy muszÄ™ kupiÄ‡ wszystkie moduÅ‚y?',
      answerMd: 'Nie, moÅ¼esz kupiÄ‡ dowolny moduÅ‚ osobno. JeÅ›li chcesz dostÄ™pu do wszystkich 3 moduÅ‚Ã³w, **pakiet** jest najkorzystniejszÄ… opcjÄ… - oszczÄ™dzasz 248 zÅ‚ w porÃ³wnaniu do zakupu osobnego (3Ã—349 zÅ‚). KaÅ¼dy moduÅ‚ to samodzielna czÄ™Å›Ä‡ programu.'
    },
    {
      id: 'faq-5',
      question: 'Jak dÅ‚ugo mam dostÄ™p do materiaÅ‚Ã³w?',
      answerMd: 'DostÄ™p do zakupionych materiaÅ‚Ã³w (PDF, filmy wideo) masz przez 12 miesiÄ™cy. MoÅ¼esz wracaÄ‡ do treÅ›ci kiedy chcesz i uczyÄ‡ siÄ™ we wÅ‚asnym tempie.'
    },
    {
      id: 'faq-6',
      question: 'Co jeÅ›li nie dam rady wszystkiego zrobiÄ‡ w tygodniu?',
      answerMd: 'Program jest elastyczny. JeÅ›li masz trudny tydzieÅ„, moÅ¼esz wrÃ³ciÄ‡ do materiaÅ‚u pÃ³Åºniej. Nie ma presji "zdÄ…Å¼yÄ‡" - waÅ¼niejsza jest konsekwencja niÅ¼ tempo.'
    },
    {
      id: 'faq-7',
      question: 'Czy to jest dieta i jadÅ‚ospis?',
      answerMd: 'NIE - to nie jest kolejna dieta z jadÅ‚ospisem. To program budowania zdrowych nawykÃ³w, uczenia siÄ™ Å›wiadomego Å¼ywienia i zmiany relacji z jedzeniem. Bez zakazÃ³w, bez presji, bez "od poniedziaÅ‚ku".'
    },
    {
      id: 'faq-8',
      question: 'Jakie efekty mogÄ™ osiÄ…gnÄ…Ä‡?',
      answerMd: 'Realistyczne efekty to: 2-4 kg tÅ‚uszczu miesiÄ™cznie, lepsza relacja z jedzeniem, wiÄ™cej energii, spokÃ³j i poczucie kontroli. MoÅ¼esz teÅ¼ pracowaÄ‡ bez wagi (centymetry, samopoczucie). Efekty zaleÅ¼Ä… od Twojej indywidualnej sytuacji i zaangaÅ¼owania.'
    },
    {
      id: 'faq-9',
      question: 'Czy program jest odpowiedni dla mnie, jeÅ›li mam PCOS/insulinoopornoÅ›Ä‡?',
      answerMd: 'TAK! Program uwzglÄ™dnia potrzeby kobiet z PCOS, insulinoopornoÅ›ciÄ…, nieregularnymi cyklami. MateriaÅ‚y zawierajÄ… konkretne wskazÃ³wki Å¼ywieniowe dla tych schorzeÅ„.'
    },
    {
      id: 'faq-10',
      question: 'Czy muszÄ™ mieÄ‡ konto, aby kupiÄ‡ dostÄ™p?',
      answerMd: 'Nie, zakup odbywa siÄ™ przez bezpiecznÄ… bramkÄ™ pÅ‚atnoÅ›ci. Po zakupie otrzymasz instrukcje, jak zaÅ‚oÅ¼yÄ‡ konto i aktywowaÄ‡ dostÄ™p do materiaÅ‚Ã³w.'
    },
    {
      id: 'faq-11',
      question: 'Czy mogÄ™ pobraÄ‡ materiaÅ‚y PDF na swoje urzÄ…dzenie?',
      answerMd: 'TAK - po zalogowaniu moÅ¼esz przeglÄ…daÄ‡ materiaÅ‚y PDF online oraz pobieraÄ‡ je na komputer, telefon lub tablet. KaÅ¼dy materiaÅ‚ jest w wysokiej jakoÅ›ci.'
    },
    {
      id: 'faq-12',
      question: 'Co jeÅ›li nie jestem zadowolona z programu?',
      answerMd: 'Rozumiem, Å¼e zakup online wymaga zaufania. JeÅ›li po rozpoczÄ™ciu programu stwierdzisz, Å¼e to nie dla Ciebie, skontaktuj siÄ™ ze mnÄ… - indywidualnie omÃ³wimy sytuacjÄ™.'
    }
  ]
}
---

<Layout title={viewModel.seo.title} description={viewModel.seo.description}>
  <PzkPurchaseAnnouncementBar
    startDate="20 stycznia 2025"
    ctaLabel="DoÅ‚Ä…cz teraz"
    ctaHref="#moduly"
  />

  <PzkPurchaseHero
    title={viewModel.hero.title}
    subtitle={viewModel.hero.subtitle}
    lead={viewModel.hero.lead}
    highlights={viewModel.hero.highlights}
    primaryCta={viewModel.hero.primaryCta}
    secondaryCta={viewModel.hero.secondaryCta}
  />

  <PzkPurchaseForWho
    title={viewModel.forWho.title}
    subtitle={viewModel.forWho.subtitle}
    painPoints={viewModel.forWho.painPoints}
    notForYouTitle={viewModel.forWho.notForYouTitle}
    notForYou={viewModel.forWho.notForYou}
  />

  <PzkPurchaseHowItWorks
    id="jak-dziala"
    title={viewModel.howItWorks.title}
    subtitle={viewModel.howItWorks.subtitle}
    features={viewModel.howItWorks.features}
  />

  <PzkPurchaseSupport
    title={viewModel.support.title}
    subtitle={viewModel.support.subtitle}
    supportFeatures={viewModel.support.supportFeatures}
  />

  <PzkPurchaseBenefits
    title={viewModel.benefits.title}
    subtitle={viewModel.benefits.subtitle}
    benefits={viewModel.benefits.benefits}
    note={viewModel.benefits.note}
  />

  {viewModel.bundle && (
    <PzkPurchaseBundleCard bundle={viewModel.bundle} />
  )}

  <section class="py-4">
    <div class="container-custom">
      <div class="text-center mb-6">
        <div class="relative">
          <div class="absolute inset-0 flex items-center" aria-hidden="true">
            <div class="w-full border-t-2 border-neutral-dark/20"></div>
          </div>
          <div class="relative flex justify-center">
            <span class="bg-neutral-light px-4 text-lg text-neutral-dark/70 font-semibold">
              lub wybierz moduÅ‚ indywidualnie
            </span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <PzkPurchaseModules
    modules={viewModel.modules}
    fallbackContactHref={viewModel.ctaBar.contactHref}
  />

  {viewModel.faq && <PzkPurchaseFaq items={viewModel.faq} />}

  <PzkPurchaseCtaBar
    showLoginLink={viewModel.ctaBar.showLoginLink}
    loginHref={viewModel.ctaBar.loginHref}
    patientGateHref={viewModel.ctaBar.patientGateHref}
    contactHref={viewModel.ctaBar.contactHref}
  />

  <PzkFloatingCta
    label="DoÅ‚Ä…cz do programu"
    href="#moduly"
    showAfterScroll={400}
    client:load
  />
</Layout>
